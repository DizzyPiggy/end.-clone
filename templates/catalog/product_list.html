{% extends "base.html" %}
{% load static %}

{% block content %}
<style>
    /* Accordion styles */
    .collapsed > div:not(:first-child) {
        display: none;
    }
    .collapsed i {
        transform: rotate(180deg);
    }
</style>
<div class="max-w-[1920px] mx-auto px-6 py-8">
    <div class="flex gap-12">

        <!-- Sidebar Filters -->
        <aside class="hidden lg:block w-64 flex-shrink-0 sticky top-32 h-[calc(100vh-8rem)] overflow-y-auto pr-4 scrollbar-hide">
            <form id="filter-form" hx-get="{% url 'catalog:product_list' %}" hx-trigger="change" hx-target="#product-grid" hx-swap="none" class="space-y-8">
                {% if current_category %}
                <input type="hidden" name="category" value="{{ current_category }}">
                {% endif %}

                <!-- BRAND Section -->
                <div class="border-b border-gray-100 pb-8">
                    <div class="flex justify-between items-center mb-4 cursor-pointer" onclick="this.parentElement.classList.toggle('collapsed')">
                        <h3 class="text-xs font-bold tracking-widest uppercase">Brand</h3>
                        <i data-lucide="chevron-up" class="w-4 h-4 transition-transform duration-300 transform"></i>
                    </div>
                    <div class="max-h-60 overflow-y-auto space-y-3 custom-scrollbar">
                        {% for brand in all_brands %}
                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input type="checkbox" name="brand" value="{{ brand.id }}" 
                                class="w-4 h-4 border-gray-300 rounded-[2px] checked:bg-black checked:border-black accent-black focus:ring-0 transition-all cursor-pointer">
                            <span class="text-xs text-black group-hover:text-gray-600 transition-colors">{{ brand.name }}</span>
                        </label>
                        {% endfor %}
                    </div>
                </div>

                <!-- COLOUR Section -->
                <div class="border-b border-gray-100 pb-8">
                    <div class="flex justify-between items-center mb-4 cursor-pointer" onclick="this.parentElement.classList.toggle('collapsed')">
                        <h3 class="text-xs font-bold tracking-widest uppercase">Colour</h3>
                        <i data-lucide="chevron-up" class="w-4 h-4 transition-transform duration-300 transform"></i>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        {% for color_code, color_name in all_colors %}
                        <label class="flex items-center gap-2 p-2 border border-gray-100 rounded cursor-pointer hover:border-gray-300 transition-colors group">
                            <input type="checkbox" name="color" value="{{ color_code }}" class="hidden peer">
                            <!-- Color Swatch -->
                            <div class="w-4 h-4 rounded-full border border-gray-200 shadow-sm
                                {% if color_code == 'Black' %}bg-black
                                {% elif color_code == 'White' %}bg-white
                                {% elif color_code == 'Grey' %}bg-gray-500
                                {% elif color_code == 'Blue' %}bg-blue-600
                                {% elif color_code == 'Red' %}bg-red-600
                                {% elif color_code == 'Green' %}bg-green-600
                                {% elif color_code == 'Yellow' %}bg-yellow-400
                                {% elif color_code == 'Orange' %}bg-orange-500
                                {% elif color_code == 'Purple' %}bg-purple-600
                                {% elif color_code == 'Brown' %}bg-amber-800
                                {% elif color_code == 'Beige' %}bg-[#E1C699]
                                {% elif color_code == 'Pink' %}bg-pink-400
                                {% elif color_code == 'Burgundy' %}bg-[#800020]
                                {% else %}bg-gradient-to-br from-blue-400 to-pink-400{% endif %}">
                            </div>
                            <span class="text-xs text-gray-700 peer-checked:font-bold">{{ color_name }}</span>
                            <!-- Check indicator -->
                            <div class="hidden peer-checked:block ml-auto w-1.5 h-1.5 bg-black rounded-full"></div>
                        </label>
                        {% endfor %}
                    </div>
                </div>

                <!-- PRICE Section -->
                <div class="pb-8">
                    <div class="flex justify-between items-center mb-4 cursor-pointer" onclick="this.parentElement.classList.toggle('collapsed')">
                        <h3 class="text-xs font-bold tracking-widest uppercase">Price</h3>
                        <i data-lucide="chevron-up" class="w-4 h-4 transition-transform duration-300 transform"></i>
                    </div>
                    <div class="flex gap-4 items-center">
                        <div class="relative flex-1">
                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-xs text-gray-500">$</span>
                            <input type="number" name="min_price" placeholder="0" 
                                class="w-full pl-6 pr-2 py-2 text-xs border border-gray-300 rounded focus:border-black focus:ring-0 transition-colors placeholder:text-gray-400">
                        </div>
                        <span class="text-gray-400">-</span>
                        <div class="relative flex-1">
                            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-xs text-gray-500">$</span>
                            <input type="number" name="max_price" placeholder="{{ max_price_limit }}" value=""
                                class="w-full pl-6 pr-2 py-2 text-xs border border-gray-300 rounded focus:border-black focus:ring-0 transition-colors placeholder:text-gray-400">
                        </div>
                    </div>
                </div>
            </form>
        </aside>

        <!-- Main Grid -->
        <div class="flex-1">
            <!-- Toolbar -->
            <div class="flex justify-between items-center mb-6">
                <span id="product-count" class="text-xs text-gray-500">{{ products|length }} products</span>
                <div class="flex gap-4 text-xs font-medium">
                    <button class="flex items-center gap-1">View <i data-lucide="chevron-down"
                            class="w-3 h-3"></i></button>
                    <button class="flex items-center gap-1">Featured <i data-lucide="chevron-down"
                            class="w-3 h-3"></i></button>
                </div>
            </div>

            <div id="product-grid">
                {% include "catalog/partials/product_grid.html" %}
            </div>
        </div>
    </div>
</div>
{% endblock %}