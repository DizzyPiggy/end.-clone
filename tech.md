# Техническое задание: E-Shop

## Описание проекта
Разработка интернет-магазина одежды и обуви, вдохновленного сайтом endclothing.com, для продажи стильной одежды, обуви и аксессуаров.

## Технологический стек
- **Backend**: Django, PostgreSQL
- **Frontend**: Tailwind CSS, HTMX, Alpine.js
- **Инфраструктура**: Docker, Nginx
- **Платежный шлюз**: NOWPayments

## Функциональные требования

### 1. Каталог продукции
- Отображение товаров с возможностью фильтрации
- Фильтрация по категориям
- Адаптивная сеточная раскладка
- Изображения, названия, цены товаров
- Сортировка (по цене, новизне, популярности)

### 2. Детальная страница товара
- Полная информация о товаре
- Галерея изображений товара
- Выбор размера
- Добавление в корзину
- Описание и характеристики товара
- Блок с похожими товарами

### 3. Корзина товаров
- Реализация в виде модального окна
- Добавление/удаление товаров
- Изменение количества
- Расчет стоимости в реальном времени
- Сохранение корзины (сессия пользователя/база данных)
- Иконка корзины со счетчиком товаров

### 4. Создание заказа
- Процесс оформления заказа
- Форма с данными покупателя (адрес доставки, контакты)
- Итоговая информация о заказе
- Выбор способа доставки
- Подтверждение заказа

### 5. Интеграция платежной системы
- Интеграция платежного шлюза NOWPayments (криптовалютные платежи)
- Реализация платежного процесса
- Отслеживание статуса заказа
- Обработка подтверждения оплаты
- Обработка вебхуков для уведомлений о платежах

## Технические требования

### Стандарты качества кода

**Безопасность:**
- CSRF-защита
- Защита от XSS-атак
- Защита от SQL-инъекций
- Безопасная обработка платежных данных
- Хранение чувствительных данных в переменных окружения
- Принудительное использование HTTPS

**Принципы ООП:**
- Class-based views где это уместно
- Наследование и абстракция моделей
- Разделение ответственности
- Инкапсуляция

**Принцип DRY:**
- Переиспользуемые компоненты
- Наследование шаблонов
- Утилитарные функции/классы
- Избегание дублирования кода

**Маппинг данных:**
- Сериализаторы для API-ответов
- DTO при необходимости
- Чистые слои трансформации данных

**Лучшие практики:**
- Типизация (type hints)
- Корректная обработка исключений
- Реализация логирования
- Оптимизация запросов к базе данных
- Стратегия индексирования
- Кеширование где применимо

### Архитектура фронтенда
- **SPA-подобный интерфейс**: Все взаимодействия через HTMX без полной перезагрузки страниц
- **Прогрессивное улучшение**: Функциональность без JavaScript, улучшение с Alpine.js
- **Адаптивный дизайн**: Mobile-first подход с использованием Tailwind CSS
- **Производительность**: Ленивая загрузка, оптимизированные ассеты

### Схема базы данных

**Структура моделей продукции:**

Используется наследование моделей (Table Inheritance) для разделения типов продукции:

- **Product** (базовая модель):
  - Общие поля: название, описание, цена, бренд, артикул
  - Изображения, категория, наличие на складе
  - Дата добавления, активность

- **Clothing** (наследуется от Product):
  - Размеры (S, M, L, XL, XXL)
  - Материал состав
  - Fit (Slim, Regular, Oversized)
  - Инструкции по уходу

- **Footwear** (наследуется от Product):
  - Размеры (EU, US, UK)
  - Материал верха
  - Материал подошвы
  - Высота (low, mid, high)

- **Accessory** (наследуется от Product):
  - Тип аксессуара (bag, hat, belt, jewelry)
  - Размеры (если применимо)
  - Материал

**Остальные модели:**

- **Categories** - иерархическая структура категорий (название, slug, описание, parent)
- **Orders** - заказы (данные покупателя, товары, сумма, статус, статус оплаты, дата создания)
- **OrderItems** - позиции заказа (ссылка на Product, количество, цена на момент покупки)
- **Cart** - корзина на основе сессий или модели для авторизованных пользователей

### Инфраструктура

**Docker:**
- Контейнеризованное приложение
- Отдельные контейнеры для Django, PostgreSQL, Nginx
- Оркестрация через Docker Compose

**Nginx:**
- Reverse proxy
- Раздача статических файлов
- SSL-терминация
- Готовность к балансировке нагрузки

## Структура проекта

```
eshop/
├── docker-compose.yml
├── .env.example
├── .gitignore
├── README.md
├── requirements.txt
├── Dockerfile
├── manage.py
│
├── nginx/
│   ├── Dockerfile
│   └── nginx.conf
│
├── static/
├── media/
│
├── config/
│   ├── settings.py
│   ├── urls.py
│   ├── wsgi.py
│   └── asgi.py
│
├── apps/
│   ├── catalog/
│   ├── cart/
│   ├── orders/
│   ├── payments/
│   └── core/
│
├── templates/
│
└── postgres/
```

### Описание приложений

**catalog/** - управление каталогом товаров и категориями

**cart/** - функционал корзины покупок

**orders/** - создание и управление заказами

**payments/** - интеграция с NOWPayments и обработка платежей

**core/** - общие компоненты, утилиты и базовые шаблоны

## Языковые требования
- Весь пользовательский контент на английском языке
- Код без комментариев (предпочтение самодокументируемому коду)

## Структура URL
```
/                          - Главная страница
/catalog/                 - Каталог продукции
/catalog/<slug>/          - Детальная страница товара
/cart/                     - Endpoint модального окна корзины
/checkout/                 - Процесс оформления заказа
/order/<id>/confirmation/  - Подтверждение заказа
/payment/callback/         - Вебхук платежной системы
```

## Результаты разработки
1. Полностью функциональное Django-приложение
2. Конфигурационные файлы Docker
3. Миграции базы данных
4. Конфигурация Nginx
5. Шаблон переменных окружения
6. Инструкции по развертыванию

## Целевые показатели производительности
- Время загрузки страницы < 2 секунд
- Time to interactive < 3 секунд
- Оценка Lighthouse > 90

## Поддержка браузеров
- Chrome (последние 2 версии)
- Firefox (последние 2 версии)
- Safari (последние 2 версии)
- Edge (последние 2 версии)